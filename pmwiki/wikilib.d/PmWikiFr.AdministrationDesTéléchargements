version=pmwiki-2.0.beta17
newline=²
time=1105748948
text=%vert% La traduction de cette page est à vérifier²²PmWiki possède une fonction codée dans @@upload.php@@ qui permet  aux utilisateurs de transférer des fichiers sur le serveur wiki à partir d'un navigateur. Ces fichiers peuvent aisément être rendus accessibles en utilisant un code dans les pages wiki. Cette page décrit comment mettre en place et configurer les transferts de fichiers.²²²!!!Quelques notes à propos de sécurité.²²1.  Garder à l'esprit que permettre aux utilisateurs (anonymement !) de télécharger des fichiers sur votre serveur web entraîne un certain nombre de risques. Le script @@upload.php@@ a été conçu pour minimiser les risques, mais les [[administrateurs du Wiki]] devraient être conscients que le potentiel de vulnérabilités existe, et qu'une mauvaise configuration de l'utilitaire de téléchargement peut aboutir à des conséquences indésirables.²²2.  Par défaut, les utilisateurs autorisés peuvent écraser les fichiers téléchargés auparavant, sans possibilité de restaurer la version précédente de ces fichiers. Si vous ne voulez pas permettre aux utilisateurs d'écraser les fichiers déjà transférés, ajoutez la ligne suivante dans votre ''config.php'':²²    $EnableUploadOverwrite = 0;²²!!!Base de l'installation²²Le script ''upload.php'' est automatiquement inclus depuis le fichier ''stdconfig.php'' si la variable @@$EnableUpload@@ est activée dans ''config.php''. De plus, dans ''config.php'' on peut configurer les variables  @@$UploadDir@@ et @@$UploadUrlFmt@@ pour préciser le dossier où les fichiers devraient être stockés, et l'URL qui peut être utilisée pour accéder à ce dossier. Par défaut, @@$UploadDir@@ et @@$UploadUrlFmt@@ suppose que les fichiers seront enregistrés dans un dossier nommé ''uploads'' situé dans le répertoire courant (usuellement celui qui contient ''pmwiki.php''). De plus, ''config.php'' devrait aussi contenir le mot de passe par défaut pour tout téléchargement (voir [[administration des mots de passe]]).²²Aussi, un fichier ''config.php'' de base paramétré pour le téléchargement devrait ressembler à ça:²    ²    <?php²      $EnableUpload = 1;²      $UploadDir = "/home/john/public_html/uploads";²      $UploadUrlFmt = [="http://www.john.com/~john/uploads";=]²      $DefaultPasswords['upload'] = crypt('secret');²      ## options de configuration additionnelles ici...²    ?>²²Pour que les transferts fonctionnent correctement, le dossier désigné par @@[=$UploadDir=]@@ doit être accessible en écriture par le processus du serveur web, et il doit être situé à un endroit publiquement accessible à partir du web (par ex., dans un sous-dossier de ''public_html''). L'[[administrateur(s) du Wiki]] peut soit créer ce dossier manuellement, ou soit laisser à Pmwiki le soin de le créer lorsque celui-ci est exécuté avec l'option de téléchargement activée (@@$EnableUpload = 1@@ dans config.php). Pour que PmWiki puisse créer le dossier, (1) changez les permissions du dossier parent à 2777, (2) lancer PmWiki avec la fonctionnalité de téléchargement activée, (3) vérifiez que le dossier upload est créé, et (4) rétablissez les permissions du dossier parent à leur valeur initiale (755 en général est une valeur sûre).  ²²Par exemple, pour que le dossier upload soit installé dans "@@/home/john/public_html/uploads@@", il faudrait faire "@@chmod 2777 /home/john/public_html@@", lancer  ''pmwiki.php'', s'assurer que le dossier upload soit bien créé ("@@ls /home/john/public_html@@"), et rétablir les permissions normales du dossier parent ("@@chmod 755 /home/john/public_html@@").²²Une fois les transferts de fichiers mis en route, les utilisateurs peuvent accéder au formulaire des téléchargements en ajoutant "?action=upload" à la fin d'une URL normale de PmWiki. Un mot de passe pour effectuer le transfert sera alors demandé aux utilisateurs de la même manière quand d'autres pages requièrent un mot de passe pour d'autres permissions (voir [[mots de passe]] et [[administration des mots de passe]] pour savoir comment établir des mots de passe sur des pages, des groupes, ou sur le site globalement).² ²Une autre façon d'accéder au formulaire de téléchargement est d'insérer le code "@@[=Attach:filename.ext=]@@" dans une page existante, où @@filename.ext@@ est le nom du fichier à transférer. Quand la page est affichée, un '?-lien' est ajouté à la fin de l'attachement et envoie l'auteur à la page des téléchargements.²²Par défaut, `PmWiki organise les fichier téléchargés dans des sous-dossiers séparés pour chaque groupe. Ceci peut être changer en modifiant la variable @@$UploadPrefixFmt@@.²²!!! Restrictions sur les fichiers téléchargés²²Le scripte ''upload.php'' effectue un certain nombre de vérifications sur un fichier téléchargé avant de l'enregistrer dans le dossier upload. Ces vérifications sont décrites ci-dessous. ²²'''noms de fichier''' -  le nom pour un fichier téléchargé peut être composé de lettres, de chiffres, de soulignés (underscore), de traits d'union et de points et il doit commencer et se terminer par une lettre ou un chiffre.²²'''extension de fichier''' - seuls les fichiers avec des extensions volontairement approuvées telles que ".gif", ".jpg", ".doc", etc. sont autorisés à être transférer sur le serveur web. Ceci est d'une importance capitale pour la sécurité du serveur, car celui-ci pourrait essayer d'exécuter ou de traiter spécifiquement des fichiers avec de extensions comme ".php", ".cgi", etc. ²²'''taille des fichiers''' - Par défaut ''upload.php'' limite tous les téléchargements à 50K de part la valeur spécifiée dans la variable @@$UploadMaxSize@@. Aussi pour pousser cette limite de tous les transferts à 100K, spécifiez simplement dans local/config.php²²    $UploadMaxSize = 100000; ²²Cependant, ''upload.php'' permet de préciser la taille maximum des fichiers pour chaque type de téléchargement. Ainsi, un administrateur peut restreindre les ".gif" et les ".jpeg" à 20K, les ".doc"²à 200K, et tous les autres à la taille indiquée par @@$UploadMaxSize@@. Le tableau de variables @@$UploadExtSize@@ est utilisé pour déterminer quelles sont les extensions valides et quelle est la taille maximum (en octets) pour chaque type de fichier. Par exemple:²²    $UploadExtSize['gif'] = 20000;      # limite les fichiers .gif à 20K²²Paraméter une entrée à zéro désactive complètement le téléchargement d'un type de fichier:²²    $UploadExtSize['zip'] = 0;          # interdit le transfert des fichiers .zip²²Un autre tableau de variables appelé  @@$UploadExts@@ est utilisé pour remplir @@$UploadExtSize@@ avec les extensions qui devraient être limitées à la valeur d'@@$UploadMaxSize@@. Par défaut, @@$UploadExts@@ contient un certain nombre d'extensions de fichier populaires (et sûrs), mais cela peut être changé par un administrateur qui voudrait limiter sévèrement les téléchargements par types.  Par exemple:²²    $UploadExts = array('gif','jpeg','jpg','png','ppt');  ²    $UploadMaxSize = 20000;²    $UploadExtSize['ppt'] = 150000;²    $UploadExtSize['doc'] = 150000;²²defini dans local/config.php autorise seulement les fichiers GIF, JPEG et PNG jusqu'à 20K, les fichers `PowerPoint et Word jusqu'à 150K, et interdit tous les autres types.²²Deux autres facteurs sont impliqués dans l'affection de la limite de taille des fichiers transférés. Dans Apache 2.0, la directive  @@[=LimitRequestBody=]@@ contrôle la taille maximum de tout ce qui est posté (les téléchargments inclus). Initialement dans Apache, cette taille est illimitée. Pourtant, certaines distributions Linux incluant Red Hat fixent cette limite à 512K aussi il peut être nécessaire de la changer ou de l'augmenter. Pour ce faire il suffit d'éditer le fichier config.php localisé dans votre dossier de configuration d'Apache (la plupart du temp dans /etc/httpd/conf.d).²²PHP lui même possède deux limites sur les fichiers téléchargés. La première est le paramètre de taille maxi d'un fichier transféré (upload_max_size), fixé à 2M par défaut. Le second est la taille maxi d'un post (post_max_size), fixé à 6M par défaut.²²Avec les variables en jeu--taille maximum de transfert de PmWiki, la limite de taille des requêtes d'Apache, et les paramètres de taille de fichier propre à PHP, la taille maximum autorisée sera la plus petite de ces trois paramètres. ²²!!!Autres notes²²*Notez que l'accès en lecture aux fichiers transférés n'est contrôlé par aucune des permissions de page ou de groupe--les fichiers transférés sont accessibles même si les pages sont protégées en lecture par un mot de passe.²²----²%trail%<<|[[Index doc admin]]|>>²²----²%tr%Traduction de PmWiki:UploadsAdmin - Page originale sur PmWiki:PmWikiFr.AdministrationDesTéléchargements²
author=PRZ
name=PmWikiFr.AdministrationDesTéléchargements
host=82.120.16.90
agent=Mozilla/5.0 (Windows; U; Windows NT 5.1; fr-FR; rv:1.7.5) Gecko/20041108 Firefox/1.0
rev=8
targets=PmWikiFr.PmWiki,PmWikiFr.AdministrateursDuWiki,PmWikiFr.AdministrationDesMotsDePasse,PmWikiFr.MotsDePasse,PmWikiFr.IndexDocAdmin,PmWikiFr.Internationalisation
