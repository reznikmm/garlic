version=pmwiki-2.0.10 ordered=1 urlencoded=1
agent=Opera/8.01 (Windows NT 5.1; U; jp)
author=fox_b
host=61.210.228.98
name=PmWikiJa.CleanURLs
rev=4
targets=PmWiki.PmWiki,Profiles.Korenev,Profiles.JoachimDurchholz,PmWikiJa.RewriteEngine,PmWikiJa.URLs,Profiles.JonBlake,PmWikiJa.CleanUrls,Profiles.Peter,Profiles.Pm,Profiles.Eldon,Profiles.Isidor,Profiles.PhilHollenback,Profiles.StuartKing,Profiles.Bang,Profiles.Jon,Profiles.Stormspotter,Profiles.OrmFinnendahl,PmWikiJa.WikiSandbox,Profiles.KenArnold,PmWikiJa.RewriteBase,PmWikiJa.LecHo,Profiles.Tparlin,Profiles.DaveHill,Profiles.Ccox,Category.Administration
text=!!Goals%0aThis recipe deals with how to get rid of that "pmwiki.php" part in the `URLs that lead to a PmWiki site.%0a%0aこのレシピはPmWikiの吐くURLから"pmwiki.php"を取り除く方法について述べる。%0a%0aThat is, PmWiki will be at `URLs like [@http://some.doman/path/to/wiki/Group/Page@] instead of [@http://somedomain/path/to/wiki/pmwiki.php?n=Group.Page@] or [@http://somedomain/path/to/wiki/pmwiki.php/Group/Page@].%0a%0aつまり、%0a [@http://somedomain/path/to/wiki/pmwiki.php?n=Group.Page@] や、%0a [@http://somedomain/path/to/wiki/pmwiki.php/Group/Page@] 形式ではなくて、%0a[@http://some.doman/path/to/wiki/Group/Page@]  形式のURLを吐くように設定する方法。%0a%0a!!Restrictions%0aThis page currently deals with Apache 1.3/2.0 in conjunction with [[http://httpd.apache.org/docs-2.0/mod/mod_rewrite.html|mod_rewrite]].%0a%0aThis page won't help you if you are using a different WWW server (such as Internet Information Server, Xitami, or Zope). It also won't help you if somebody else is in control of the Apache installation and refuses to install or activate mod_rewrite for you, or has Apache configured in a way that your [[http://httpd.apache.org/docs-2.1/howto/htaccess.html|''.htaccess'']] files are ignored.%0a%0a----%0a%0a!!Technique 1: .htaccess and mod_rewrite%0aUse this technique if you cannot (or don't want to) modify your main Apache configuration files (httpd.conf et al.).%0a%0aAll changes are made in the PmWiki installation directory (i.e. the directory that contains @@pmwiki.php@@), which is supposed to be in [@/DocumentRoot/path/to/wiki@], and has URL [@http://some.domain/path/to/wiki/@].%0a%0a!!! @@config.php@@ Edit: %0a%0aTo make PmWiki display the shorter `URLs, you'll have to set%0a%0a  $ScriptUrl = [='http://some.domain/path/to/wiki'=]%0a%0ain @@config.php@@ (no trailing slashes).%0a%0aOn its pages, PmWiki will normally generate query-style `URLs of the form [@http://some.domain/path/to/wiki/pmwiki.php?n=Group.Page@]. To make it generate path-style `URLs like [@http://some.domain/path/to/wiki/Group/Page@], set%0a%0a  $EnablePathInfo = 1;%0a%0a!!! wiki root edit:%0a%0aFirst, create or change a file named @@index.php@@ so that it reads:%0a%0a  %3c?php include 'pmwiki.php';%0a%0aThis will make sure that `URLs like%0a%0a  [=http://some.domain/path/to/pmwiki=]%0a%0awill automatically call pmwiki.php. (This should actually work with all servers.) This step isn't strictly necessary, but it's a safety net in case that a URL like the above makes it through the rewrite engine without being rewritten.%0a%0a->I prefer to include this line in .htaccess instead:[[%3c%3c]]%0a-->[@DirectoryIndex pmwiki.php@][[%3c%3c]]%0a->This gives you a clean url for the site root.[[%3c%3c]]%0a->In this case you have to omit the first rewrite rule though.[[%3c%3c]]%0a->Anno%0a%0a->If it doesn't work, change the %3cDirectory> section in http.conf:%0a-->[@AllowOverride Indexes@]%0a->[[~Korenev]]%0a%0a->I think the potential [@AllowOverride@] complexities make [@DirectoryIndex@] a less useful solution. Besides, the [@index.php@] trick always works, so why bother with [@.htaccess@] in the first place?%0a->[[~Joachim Durchholz]] September 28, 2005, at 03:05 PM%0a%0a!!! .htaccess%0aAfter that, create or change a file named @@.htaccess@@ so that it reads:%0a [=%0a  Options +FollowSymLinks%0a  RewriteEngine on%0a%0a  # Redirect browsers that use an empty URL%0a  # to the default URL.%0a  RewriteRule ^/?$ http://some.domain/path/to/wiki/dir/Main/HomePage [R=permanent,QSA,L]%0a%0a  # Map URLs that start with anything but a lower-case letter to pmwiki.php.%0a  # The remaining URLs are left to the default map-to-filesystem routine of Apache.%0a  RewriteRule ^([^/a-z].*) pmwiki.php?n=$1 [QSA,L]%0a =]%0a->If you see "Options not allowed here" or "RewriteEngine not allowed here" change \%0athe %3cDirectory> section in http.conf:%0a-->[@AllowOverride Indexes Options FileInfo@]%0a->[[~Korenev]]%0a%0a->You may need to add a [[http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritebase|RewriteBase directive]] if you get a 404 error when accessing the clean URLs%0a-->[@RewriteBase /logical/path/to/wiki@]%0a->[[~JonBlake]]%0a%0a''You can leave out the comment lines that start with a hash mark @@#@@, but it's probably a good idea to leave them in anyway: if you or somebody else wants to modify the configuration later, the comments will help in understanding what the directives do.''%0a%0aThe first two directives enable rewrite processing. (Yes, you need [@FollowSymLinks@] - the rationale is that if symlinks are not allowed, the far more powerful abilities of mod_rewrite shouldn't be allowed either.)%0a%0aThe first [@RewriteRule@] redirects [@http://some.domain/path/to/wiki/dir@] and [@http://some.domain/path/to/wiki/dir/@] to the start page of the wiki. (Feel free to select a different group and page than [@Main/HomePage@] if you wish.) The final [@[R]@] option establishes the rewrite in a way that the user's browser is notified and can update the address bar.%0a%0aThe second [@RewriteRule@] takes the URL and inserts @@pmwiki.php/@@ at the right place. It does not apply to `URLs that begin with a lowercase letter (because these are reserved for `URLs that contain all sorts of auxiliary information: @@pub/skins@@, @@pub/css@@, @@favicon.ico@@, and last but not least @@pmwiki.php@@ itself). It also avoids rewriting `URLs that start with a slash, since sometimes the rewrite rule will be fed with absolute directory paths (which are guaranteed to start with a slash - on a Windows system, you should probably do something like [@ RewriteRule ^([^\\a-z][^:\\]?.*) pmwiki.php/$1@] to capture UNC names and names starting with a drive letter).%0a%0aThe second [@RewriteRule@] could also be written as%0a%0a  `RewriteRule ^([^/a-z].*) pmwiki.php?n=$1 [QSA,L]%0a%0aThis might be necessary if path-style `URLs don't work (it seems to be possible to misconfigure Apache and/or PHP in this way). The [@QSA@] option is necessary to preserve [@?action=edit@] and similar things - this tells mod_rewrite to add the [@?n=$1@] string to the URL instead of replacing everything after the first question mark.%0a%0a!!!Troubleshooting%0aIf there is some problem with the rewrite rules, turn on rewrite logging (@@[[http://httpd.apache.org/docs/mod/mod_rewrite.html.en#RewriteLog|RewriteLog]] /path/to/rewrite.log@@) and set the rewrite log level to 9 ([@RewriteLogLevel 9@]) if you can. This will tell you in excruciating detail when and what mod_rewrite is doing, and give you hints where the problem actually is. Rewriting is an iterative process, and if you get an error message, it may be working on a URL that was already rewritten to something not even remotely similar to what you'd expect.%0a%0aTo switch on rewrite logging, you need access to @@httpd.conf@@. If you don't have that (that's quite the normal case), set up a test installation on your personal computer. For a Windows box, you can get a quite painless install from http://apachefriends.org.%0a%0aNote 1. This recipe will work even if you have a wiki-only site (i.e. if @@pmwiki.php@@ is in the document root, and users are expected to use `URLs like [@http://some.domain/Group/Page@]).%0a%0aNote 2. To make PmWiki display the shorter `URLs, you'll have to set%0a%0a  $ScriptUrl = [='http://some.domain/path/to/wiki'=]%0a%0ain @@config.php@@ (no trailing slashes). To make PmWiki generate path-style `URLs (i.e. [@.../Group/Page@] instead of [@...?n=Group.Page@] in the pages that it outputs, set%0a%0a  $EnablePathInfo = 1;%0a%0a[[~Joachim Durchholz]] April 01, 2005, at 02:25 PM%0a%0a----%0a%0a!!Technique 2: "Alias"%0a%0aUse the aliasing feature of Apache.  Edit the ''httpd.conf'' file, and add%0aa line like%0a%0a Alias /wiki "/var/www/html/pmwiki.php"%0a%0awhere you would of course specify the correct path to pmwiki.php. Then put%0a%0a $EnablePathInfo = 1;%0a $PubDirUrl = "http://www.someserver.com/pub";%0a%0ain ''config.php''.%0a%0aadding the correct path to the "pub" directory with out the pmwiki.php. Alias messes up the links into the pub directory when pmWiki tries to auto sence that.%0a%0a->Note that this requires write access to the @@httpd.conf@@ file (since @@Alias@@ directives aren't allowed in directory or @@.htaccess@@ context). Most webspace providers disallow this, since it's easy to kill Apache by providing invalid content in @@httpd.conf@@. -- [[~JoachimDurchholz]] 22 Mar 2005%0a%0a----%0a%0a!!Technique 3: Apache Configuration%0aAgain, this requires write assess to @@httpd.conf@@.%0a* Enable mod_rewrite [-[@LoadModule rewrite_module modules/mod_rewrite.so@]-]%0a* Add a @@[[http://httpd.apache.org/docs-2.0/mod/core.html#directory|Directory]]@@ directive for your pmwiki directory (this is where your @@.htaccess@@ file exists).%0a* Specify @@[[http://httpd.apache.org/docs-2.0/mod/core.html#allowoverride|AllowOverride]] Options@@, or Apache will not process options found in the @@.htaccess@@ file.%0a* Specify @@[[http://httpd.apache.org/docs-2.0/mod/core.html#options|Options]] `FollowSymLinks@@%0a* Don't forget to restart Apache%0a%0a----%0a%0a!!Questions & Discussion%0a%0a'''CleanUrls does not work on my pages...''' I'm not experienced enough in programming, so I don't get it to work. First, I have pmwiki.php renamed to index.php (and it works very well); then, I have installed pmwiki on my root-directory; when changing the lines in my .htaccess in the root directory, none of my scripts are working correctly, my server didn't allow anything. I had to upload the old .htaccess via ftp to get it all back to work. Is it a prob depending on my retail-hoster does not allow such kind of manipulation? How can I find out if the Apache's "mod_rewrite" capabilities are working? %0a*[[[~Peter]] December 28, 2004, at 01:36 AM%0a%0a-> %25Pm%25 It's possible that your web server doesn't allow url rewriting (some don't).  Is there a URL that I could look at -- maybe I can figure something out.  --[[~Pm]]%0aYes, see %25newwin%25 http://www.belepe.de , some new family-pages of mine. I have tried to get some information from my hoster, but they need time to answer...%0a*[[[~Peter]] December 28, 2004, at 03:34 PM%0a%0a-> The `URLs on your pages seem to be rather different from what they should be. For example, on I found http://www.belepe.de/index.php/$Group/Schnippsel?action=edit (note the dollar sign before "Group"). [[~JoachimDurchholz]]%0a%0a-----%0aI couldn't get the directions on step 2 to work on my commercial webhost that does give me access to .htaccess file, but not a full path to the folders I'm given.  I got it working when I changed the .htaccess file in the root of the pmwiki installation to look like below - with no path to pmwiki at all and following all other directions.%0a [=%0a     RewriteEngine on%0a     RewriteRule ^([A-Z].*) pmwiki.php?n=$1 [L,qsappend]%0a     RewriteRule ^$ pmwiki.php [L,qsappend]%0a =]%0a--[[~Eldon]]%0a%0a->You can easily discover the pathnames used on your webhost by putting up a simple php script that looks like%0a [=%0a     %3c?%0a       phpinfo();%0a     ?>%0a =]%0a->The very bottom of the huge mass of output should list all the relevant directories.%0a-> -- bishop-at-platypus.bc.ca%0a%0a-----%0aMy webhoster also doesn't allow any .htaccess file changes. Is there a standard workaround to this problem? If the solution isn't all that complex and works in most cases, it might be a good idea to add it to the page. I could imagine many others are in the same situation as I am.%0a%0a-> You're out of luck. Change the webhoster or live with the long `URLs. -- [[~JoachimDurchholz]] 22 Mar 2005%0a%0a----%0aThis seems like a long shot, but is there a way to configure PmWiki to use the 'Main' namespace implicitly - but hide it from the urls?%0a%0a-> You need a [@RedirectMatch@] that maps `URLs with "Main" in them to the plain `URLs (PmWiki will generate those `URLs). You'll also need a [@RewriteRule@] that matches only those `URLs that don't contain the group name and inserts a "Main/" at the appropriate place. (Results from [@RedirectMatch@] are shown in the address bar of the browser, results from [@RewriteRule@] aren't.) -- [[~JoachimDurchholz]] 22 Mar 2005%0a%0a----%0aJan 24, 2005%0a%0aI tried to set this up on a local wiki. Our admin was setting up a certificate so that the wiki would be accessible via https. However it seems that when using 'Clean form' the links point back to HTTP server vs HTTPS. Any way to fix or address this? Thank you.%0a%0a-->-- Gennady%0a%0a->%25Pm%25  Sure, just set the value of $ScriptUrl explicitly to use a relative uri (i.e., to omit the leading [@http://server@] part).  --[[~Pm]]%0a%0a----%0aTried the above howto and it works fine. But uploading doesn't work anymore, I had to change the upload.php and change the action to ~/pmwiki.php -- ''UH''%0a%0a----%0aJust a '''Tip''' to easily define the directories %0a [=%0a    $EnablePathInfo = 1;%0a    $BaseUrl = 'http://'.$_SERVER[HTTP_HOST];%0a    $ScriptUrl = $BaseUrl.'/~me/pmwiki';%0a    $PubDirUrl = $BaseUrl.'/~me/pmwiki/pub';%0a    $UploadUrlFmt = $BaseUrl.'/~me/pmwiki/uploads';%0a =]%0ashould work fine --[[~Isidor]]%0a----%0a-> %25red%25''Note: This does not work with Windows 2K. -Doug Parker''%25%25%0a-> %25Pm%25 Is it that it doesn't work with Windows 2K, or that it doesn't work with IIS?  Many people have Apache running under Windows, where this ought to work...?  --[[~Pm]]%0a----%0a%0aNote on localization - this does not seem to work with swedish characters, i.e. Å, Ä, Ö. Has something to do with http?%0a%0a-> My guess is that this was a problem with an old version of the recipe where `URLs using uppercase lessers in the A-Z range were taken to be wiki pages. The current version considers everything not in the a-z range to be a wiki page, so pages with umlauts and other "funny characters" in their name should work. [[~Joachim Durchholz]] April 01, 2005, at 02:25 PM%0a%0a----%0a%0aI really hate how pmwiki handles `URLs. This helps, but is there a way to get rid of the annoying /Main/ part and possibly also avoid capitalization of every sentence in `URLs as it looks incredibly stupid in any other language than English.%0a%0a->%25Pm%25 Propose an alternative url syntax.  --[[~Pm]]%0a%0a->Use the ?n=Group/Page syntax. [[~Joachim Durchholz]] April 01, 2005, at 02:25 PM%0a%0a----%0a%0aI followed all the instructions and it didn't work... Finally I realized my .htaccess file was being ignored.  When I checked my httpd.conf I found the following:%0a [=%0aAllowOverride None%0a=]%0awhich completely disables .htaccess files.  That is the default configuration on Fedora Core 1 Linux with Apache 2.0.50.%0aChanging that line to:%0a [=%0aAllowOverride All%0a=]%0aand restarting httpd fixed the problem.%0a%0a--[[~PhilHollenback]] 2005-3-21%0a%0a->You've jeopardized security.  I strongly recommend you only do that in %3cdirectory> statements which cover the pmwiki installation dir.%0a%0a-> --bishop-at-platypus.bc.ca%0a%0a----%0a%0aWorked first time for me.%0aHowever, now all the default PmWiki pages which I%0aplanned to leave there have links in the old format :b%0aAny easy workaround?%0a--Riccardo G. '-2005-3-30-'%0a%0a-->%25Pm%25 Shouldn't be any workaround needed -- PmWiki will still continue to recognize the old-format links.  --[[~Pm]]%0a%0a----%0a%0aURL Rewriting under Apache 1.x on Win32 (the one from http://httpd.apache.org, I can't speak for the http://apachefriends.org version) doesn't work - see: http://issues.apache.org/bugzilla/show_bug.cgi?id=23460%0a%0aUsing Apache 2.0+ (as per the link above) is apparently the only solution for those stuck with Win32. To quote the last entry in the bugzilla issue above:%0a%0a->Whoops.  Ok, this has simply got to be marked won't fix.%0a%0a->As I said 15 months ago - it is simply NOT possible to straighten this out in Apache 1.3/Win32.  Nothing has changed, or will change, in that answer.  If you don't like the behavior (certainly I don't :-) then upgrade to 2.0.%0a%0a@@[=AllowOverride All=]@@ is still required in the httpd.conf file to allow .htaccess files to work.%0a%0a[[~StuartKing]]%0a%0a->%25maroon%25the problem is that Windoze Apache 1.3 converts all parts of a URL that appear to be a directory/file path to lower case ''before'' the URL is processed by the rewrite engine.  this means that rewrite rules which depend on a leading capital letter will not work.  in general, if the page URL ends with '.../Group/Page', interCaps will (sometimes?) be lost in the group name, and if it ends with '.../Group.Page they are lost on the page name as well.  fwiw, --[[~bang]] June 04, 2005, at 09:01 AM%0a%0a----%0a%0aAs at 2.0 b32 an extra command (and the index.php trick above) needs to be used to allow searching to work:%0a%0a[@RewriteEngine on@]%0a%0a'''[@RewriteCond %25{QUERY_STRING} ^$@]'''\\%0a[@RewriteRule ^/?$ http://wiki.server/path/Main/HomePage [R=permanent,L]@]%0a%0a[@RewriteRule	^([^/a-z].*)	pmwiki.php?n=$1 [QSA,L]@]%0a%0aWithout this you will get a url like so:\\%0a[@http://wiki.server/path/Main/HomePage?n=Main%252FSearchWiki&q=search+string@]%0a%0aWith it you get a url like this:\\%0a[@http://wiki.server/path/?n=Main%252FSearchWiki&q=search+string@]%0a%0a[[~StuartKing]]%0a%0a->%25red%25Perhaps this ought to be placed in the instructions above - this seems to me a fairly important fix... [[~Jon]]%25%25%0a%0aThe same still applies in Apache 2.0.54. [[~stormspotter]]%0a----%0aFor this method to work, Apache has to be configured to support rewriting. Add this to your httpd.conf:%0a%0a@@[=LoadModule=] rewrite_module /path/to/your/apache2/modules/mod_rewrite.so@@ %0a%0aAnd make sure, the pmwiki directory allows rewriting by adding the @@[=AllowOverride All=]@@ statement mentioned above into that file.%0a%0aOn my machine, I run debian which puts the apache modules into /usr/lib/apache2/%0a%0aDebian uses the following mechanism: /etc/apache2/ contains two directories with the names ''mods-available'' (all available modules) and ''mods-enabled''. To enable an available module, simply symlink the corresponding file in ''mods-available'' into the ''mods-enabled'' directory: Debian's apache startup takes care of loading the module (You will still have to add the @@[=AllowOverride All=]@@ directive though).%0a%0a[[~Orm Finnendahl]]%0a%0a----%0aOn a site hosted with Apache 2, I'm having an annoying problem. The url rewriting works fine, except when I follow a link, there is an extra '/' in the url. For example, you're in the WikiSandbox and you want to go back to the main page, so you click the link and it will take you to http://www.mydomain.com/wiki//Main/HomePage instead of http://www.mydomain.com/wiki/Main/Homepage. %0a%0aI know it's fine to leave it like this, as it's working, but it doesn't look as 'pretty' as I'd like it to. Especially when I'm already using mod_rewrite to clean up the url.%0a%0aAny suggestions for how I can fix this? %0a%0a[[~stormspotter]]%0a%0aI forgot to mention, if you want to see the problem on the site I have under development right now, you can go to http://bb.6texans.net . [[~stormspotter]]%0a%0a [=$ScriptUrl = 'http://bb.6texans.net/home';=]  %0aNOT%0a [=$ScriptUrl = 'http://bb.6texans.net/home/';=]%0a%0aAnno%0a%0asigh... Looks like I overlooked the obvious again. Thanks, Anno. [[~stormspotter]]%0a%0aI cant get this to work on my site. I got the path style URLs to work but it still puts index.php or pmwiki.php in the url.%0a-- Austin ( http://www.yqmonline.com/wikiwikiwha )%0a%0a!!Contributors%0a%0a* [[~Pm]], 2004-12-19%0a* [[~Joachim Durchholz]] April 01, 2005, at 02:25 PM%0a* [[~Orm Finnendahl]] May 09, 2005, at 12:02 AM%0a* [[~Ken Arnold]] June 16, 2005, at 3:32 PM%0a%0a----%0a!! ADD:%0aHello!%0a%0aIt took me a couple of days, but now it works ... %0a%0aI was told to use a RewriteBase function in addition ...%0a%0amy final .htaccess:%0a  [=%0a#my pmwiki.php is located at http://www.some.domain/~username/MyTry/pmwiki.php%0a#Options +FollowSymLinks   - was not supported - always generated error%0aRewriteEngine on%0aRewriteBase /~username/MyTry/%0aRewriteCond %25{QUERY_STRING} ^$%0a#and the stuff mentioneed at the beginning%0aRewriteRule ^/?$ http://www.some.domain/~username/MyTry/Main [R=permanent,QSA,L]%0aRewriteRule ^([^/a-z].*) pmwiki.php?n=$1 [QSA,L]%0a  =]%0a%0aAdditionally it's don't forgrt to add to your config.php%0aa couple of lines proposed by [[~Isidor]] :-)%0a  [=%0a$EnablePathInfo = 1;%0a$BaseUrl = 'http://www.some.domain';%0a$ScriptUrl = $BaseUrl.'/~username/MyTry';%0a$PubDirUrl = $BaseUrl.'/~username/MyTry';%0a$UploadUrlFmt = $BaseUrl.'/~username/MyTry/uploads';%0a=]%0a%0aotherwise you might find some links not working on your webpage (especially attachements - since the 'uploads' dir got translated wrong...)%0a%0aCheers!%0aLecHo%0a%0a----%0aMy Solution:%0a%0aCreate .htaccess file in root directory of wiki that looks like so:%0a%0a-->[@DirectoryIndex pmwiki.php@][[%3c%3c]]%0a%0a-->[@RewriteEngine on@]%0a-->[@RewriteCond %25{QUERY_STRING} ^$@]%0a-->[@RewriteRule ^/?$ http://wiki.squible.com/Main/HomePage [R=permanent,QSA,L]@]%0a-->[@RewriteRule ^([^/a-z].*) /pmwiki.php?n=$1 [QSA,L]@]%0a%0aI had to add an extra "/" in front of pmwiki.php%0a%0aCheers,\\%0a-[[~tparlin]]%0a%0a----%0aIf you are using "?" style URLs, then you need to use:%0a%0a-->[@RewriteRule ^([^/a-z].*) pmwiki.php?n=$1 [QSA,L]@]%0a%0aIf you are using "slash" style URLs ("$EnablePathInfo = 1;" in config.php) then this line needs to be:%0a%0a-->[@RewriteRule ^([^/a-z].*) pmwiki.php/$1 [QSA,L]@]%0a%0aLeastways, that's what I needed to do to make it work.%0a%0a-Profiles/DaveHill%0a%0a----%0aI'm pretty sure you can do this with IIS, you just need a whole different configuration (i.e. not .htaccess).  I'm running Win2003 w/ IIS 6. I'll let ya'll know how things work out, but if anybody has suggestions, I'll be listening as I'm working.  BTW, does anybody know how to do a masked redirect using IIS? That would essentially solve this problem, then all you have to do is use aliases.%0a%0a-Michael Ansel%0a%0a----%0aThe following .htaccess works for 1and1 shared hosting (Apache 1.3.33, PHP 4.3.10):%0a%0a[@Options +FollowSymLinks%0aRewriteEngine on%0a%0a# RewriteBase is the directory where pmwiki.php lives%0aRewriteBase /stw%0a%0a# Redirect browsers that use an empty URL to Main.HomePage%0aRewriteRule ^/?$  /stw/Main/HomePage [R=permanent,QSA,L]%0a%0a# Map URLs that start with anything but a lower-case letter to pmwiki.php.%0a# The remaining URLs are left to the default map-to-filesystem routine of Apache.%0aRewriteRule ^([^/a-z].*) pmwiki.php?n=$1 [QSA,L] @]%0a%0a-Jefferson%0a----%0aI too, found this recipe to be cumbersome.  So here is my solution step by step.%0a%0aLet's assume:%0a%0a# `DocumentRoot is /www%0a# PmWiki installed at /www/pmwiki%0a# Upload directory at /www/pmwiki/uP%0a%0aLet's say that you would like your URLs to look like:%0a%0a [=http://my.domain/wiki/Main/HomePage=]%0a%0aMy /www/.htaccess file is:%0a%0a [=%0aOptions -Indexes%0aErrorDocument 403 /noindex.html%0aRewriteEngine On%0aRewriteRule ^/?$ http://mydomain.com/wiki/Main/HomePage [R=permanent,QSA,L]%0aRewriteRule ^wiki$ http://mydomain.com/wiki/Main/HomePage [R=permanent,QSA,L]%0aRewriteRule ^wiki/uP/([^/a-z].*) /pmwiki/uP/$1 [QSA,L]%0aRewriteRule ^wiki/([^/a-z].*) /pmwiki/pmwiki.php?n=$1 [QSA,L]%0a =]%0a%0aNow, in my /www/pmwiki/local/config.php file:%0a%0a [=%0a$ScriptUrl = 'http://mydomain.com/wiki';%0a$PubDirUrl = 'http://mydomain.com/pmwiki/pub';%0a$EnablePathInfo = 1;%0a$EnableUpload = 1;%0a$UploadDir = 'uP';%0a$UploadUrlFmt='http://mydomain.com/wiki/uP';%0a =]%0a%0aI also have:%0a%0a [=%0a%3c?php include 'pmwiki/pmwiki.php'; ?>%0a =]%0a%0ain my /www/index.php, but maybe that's not required (?).%0a%0a%0a[[~ccox]]%0a%0aCategories: [[!Administration]]%0a
time=1128857917
