version=pmwiki-2.1.5 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.2) Gecko/20060308 Firefox/1.5.0.2
author=Holo
csum=translated
ctime=1145631157
host=195.98.173.2
name=PmWikiRu.PasswordsAdmin
rev=1
targets=PmWikiRu.Passwords,PmWikiRu.Security,PmWikiRu.WikiGroup,PmWikiRu.WikiAdministrator,PmWikiRu.LocalCustomizations,PmWikiRu.AuthUser,PmWikiRu.PasswordsAdmin,PmWikiRu.ConditionalMarkup,PmWikiRu.DocumentationIndex
text=(:title Администрирование паролей:)%0a%0a%25audience%25 администраторам (основы)%0a%0aУ PmWiki имеется встроеная поддержка [[Passwords|защиты паролем]] различных областей вики сайта. %0aПароли могут быть назначены на отдельные страницы, на [[Вики Группы -> Wiki Group]] или весь вики сайт. Обратите внимание, что описаный здесь механизм защиты паролем всего лишь малая часть всей системы безопасности(и в целом вики), более подробное обсуждение смотри на странице [[Security|+]].%0a%0aКак описано в разделе [[Passwords|+]], авторы могут с помощью PmWiki устанавливать пароли как на отдельные страницы, так и на ВикиГруппы. Однако, как описано далее, [[администраторы вики-> WikiAdministrator]] ко всему прочему могут устанавливать пароли в файлах [[местной настройки -> local customizations]].%0a%0a!! Основы%0a%0aPmWiki поддерживает несколько уровней доступа к страницам вики:%0a-> @@read@@ пароли позволяют просматривать содержимое страниц вики%0a-> @@edit@@ пароли управляют редактированием и изменением страниц вики%0a-> @@attr@@ пароли указывают кто правоспособен устанавливать пароли на страницы (и потенциально другие атрибуты)%0a-> если закачка разрешена, @@upload@@ пароли управляют закачкой файлов%0a%0aИ наконец, есть ещё пароль @@admin@@ позволяющий администратору перекрыть установленые пароли для отдельных страниц или групп.%0a%0aПо умолчанию, PmWiki имеет следующие настройки паролей:%0a* Пароли @@admin@@ и @@upload@@ по умолчанию закрыты;%0a* Группы Main и PmWiki закрыты паролем @@attr@@ (на их собственных страницах GroupAttributes);%0a* Страницы в группе Site, за исключением Site.SideBar, закрыты для редактирования.%0a%0aПароль @@admin@@ используется для обхода "закрытых" паролей, т.е. не тех, у которых нет пароля на доступ.%0a%0aСмотри страницу [[Passwords]] подробно описывающую установку паролей на страницы и группы. Продолжение этой страницы описывает установку паролей для всего сайта с помощью файла ''local/config.php''.%0a%0a!! Установка паролей для всего сайта%0a%0aПервое, что должен настроить админ -- это пароль всего сайта @@admin@@.  Это делается одной строкой в файле ''local/config.php'':%0a%0a    $DefaultPasswords['admin'] = crypt('secret_password');%0a%0aЗаметьте, что вызов crypt() здесь необходим -- PmWiki внутри хранит и обрабатывает все пароли в виде зашифрованых строк.  О подробностях об устранении читаемых паролей из файлов настроек смотри ниже [[раздел шифрования -> #crypt]].%0a%0aДля настройки редактирования всего сайте только теми, что знает "edit" пароль добавьте строку подобную следующей в ''local/config.php'':%0a%0a    $DefaultPasswords['edit'] = crypt('edit_password');%0a%0aАналогично вы можете установить пароли [@$DefaultPasswords['read']@], [@$DefaultPasswords['edit']@] и [@$DefaultPasswords['upload']@] для управления чтением, редактированием и закачкой файлов для всего сайта. Пароли по умолчания используются только для страниц или групп не имеющих настроеных паролей. Ко всему прочему, каждое значение $DefaultPasswords может быть массивом зашифрованых паролей:%0a%0a    $DefaultPasswords['read'] = array(crypt('alpha'), crypt('beta'));%0a    $DefaultPasswords['edit'] = crypt('beta');%0a%0aЧто говорит, что оба пароля "alpha" или "beta" используются для чтения страниц, но только пароль "beta" позволяет кому-либо редактировать страницу.  Впоследстсвии PmWiki запоминает все пароли введёные во время текущей сессии, пароль "beta" позволить и редактировать и менять страницы, когда как "alpha" позволяет только чтение.  Личность не введшая какой-либо пароль не сможет просмотреть страницы.%0a%0a!! Индивидуальная авторизация (имя/пароль регистрация, [[AuthUser|+]])%0a%0aВ отличии от множества систем использующих для доступа к страницам индивидуальную авторизацию (т.е. у каждого пользователя отдельное ''имя'' и ''пароль''), PmWiki изначально пользуется системой паролей.  В основном защита только паролем часто проще в поддержании, потому что она не требует административной нагрузки для создания учётных записей пользователей, восстановления забытых паролей, управления правами пользователей.%0a%0aОднако, сценарий PmWiki ''authuser.php'' добавляет к системе паролей возможность доступа к страницам по комбинации имени пользователя и пароля.  О подробностях по управлению доступа к страницам по идентификации пользователя смотри [[AuthUser|+]].%0a%0a!!Дыры безопасности ...%0a%0aАдминистратору стоит очень внимательно планировать применение паролей во избежание открытия дыр в системе безопасности по невнимательности.  Если ваша вики открыта (кто угодно может читать и править), это казалось бы не беспокоит,  '''за исключением''' случая злобного или запутавшегося пользователя могущего установить пароль чтения на группу и тем самым сделать её недоступной для остальных пользователей.  По наикрайнейшей мере, даже открытая вики должна иметь для всего сайта пароли "admin" и "attr" установленые в файле config.php.  Распространяемы с PmWiki файл ''sample-config.php'' указывает, что группы PmWiki и Main имеют изначально запертый "attr", но если кто-либо создаст новую группу, то "attr" отопрётся.  В таком случае администраторам надо помнить об установке пароля "attr" для каждой новой группе (по необходимости).  Простейшее решение -- это вставить следующие строки в ''config.php'':%0a%0a-> [@%0a$DefaultPasswords['admin'] = crypt('ваш-admin-пароль');%0a$DefaultPasswords['attr'] = crypt('ваш-admin-пароль');%0a@]%0a%0a!! Шифрование паролей в ''config.php'' [[#crypt]]%0a%0aУ использования функции crypt() для установки паролей в файле ''config.php'' есть один недостаток -- кто-нибудь может просмотреть файл и увидеть незашифрованый пароль.  Например, если ''config.php'' содержит%0a%0a    $DefaultPasswords['admin'] = crypt('mysecret');%0a%0aто пароль "mysecret" явен для других смотрящих.  Однако, администратор вики может получить и использовать зашифрованую форму пароля напрямую воспользовавшись [@?action=crypt@] на любой странице PmWiki (или просто перейти на [[{$Name}?action=crypt]]).  Это дейстивие выдаёт форму для генерации зашифрованых версий паролей в пригодном виде для файла ''config.php''.  Например, когда [@?action=crypt@] получит пароль "@@mysecret@@", PmWiki вернёт строку вроде%0a%0a    $DefaultPasswords['type']=[='$1$vR4.Ma1.$llNADCnbvJRxIE/hqnucA.'=];%0a%0aСтрока полученая из [@?action=crypt@] может быть помещена прямо в config.php, как в:%0a%0a    $DefaultPasswords['admin']=[='$1$vR4.Ma1.$llNADCnbvJRxIE/hqnucA.'=];%0a%0aОбратите внимание, что в зашифрованой форме ключевое слово ''crypt'' и скобки удалены, так как пароль уже зашифрован.  Кроме того, зашифрованый пароль дожен быть заключён в одиночные апострофы.  В данном примере пароль всё ещё "@@mysecret@@", но кто-либо заглянувший в ''config.php'' не сможет его подсмотреть даже увидев его зашифрованую форму.  ''Crypt'' может дать вам другие шифры для одного и того же пароля -- это нормально (и затрудняет определение исходного пароля).%0a%0a!! Снятие пароля%0a%0aЧтобы полностью удалить с сайта, такой как по умолчанию закрытый пароль для закачек, просто установите в значение пустой строки:%0a%0a    $DefaultPasswords['upload'] = '';%0a%0aТакже вы можете использовать специальный пароль "nopass"(определяемый переменной $AllowPassword) через действие @@?action=attr@@, чтобы получить страницу без защиты паролем в закрытой паролем группе или группу без пароля на закрытом паролем сайте.%0a%0a!! Отмена или анулирование паролей%0a%0aЕсли пароль скомпрометирован и администратор вики хочет быстро анулировать всех пользователей с таким паролем на сайте, то проще в файле ''local/config.php'' добавить следующие строки:%0a%0a    $ForbiddenPasswords = array('secret', 'tanstaafl');%0a    if (in_array(@$_POST['authpw'], $ForbiddenPasswords)) %0a      unset($_POST['authpw']);%0a%0aЭто не допускает принятие от кого-либо "secret" и "tanstaafl" как действующиего пароля авторизации, независимо от того пользуются им страницы или нет.%0a%0a!! Также смотри%0a%0a* Массив $HandleAuth устанавливающий требуемый уровень авторизации необходимый для выполнения действия(action).%0a%0a!! Защита действий (пример)%0a%0aКаждое действие может быть защищено паролем.  Авторы Рецептурника снабжающие сценарии собственными действиями также могут использовать такой приём, но я упростил пример до (по умолчанию) не защищённого [@?action=source@].  Это действие показывает исходную разметку страницы.  Иногда вы не желаете её показывать, особенно при использовании [[условной разметки -> conditional markup]], которая не должна открываться легко и быть доступной только тем, у кого есть права на правку.%0a%0aДля этого есть несколько решений:%0a# Чтобы разрешить "source" только редакторам добавьте следующиее в ваш ''local/config.php'':%0a%0a--> [@$HandleAuth['source'] ='edit';@]%0a%0a# Для использования "source" с собственный паролем добавьте:%0a%0a--> [@$HandleAuth['source'] ='source';@]%0a--> [@$DefaultPasswords['source'] = crypt(secret);@] # ''смотри выше''%0a%0a  Если вы дополнительно хотите установить пароль в атрибутах страницы, то добавьте:%0a%0a--> [@$PageAttributes['passwdsource'] = "$['Set new source password']";@]%0a%0a%25trail%25%3c%3c|[[Documentation Index|+]]|>>
time=1145631157
title=Администрирование паролей
