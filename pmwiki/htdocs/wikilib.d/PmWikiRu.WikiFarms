version=pmwiki-2.1.5 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.3) Gecko/20060426 Firefox/1.5.0.3
author=Holo
csum=descriptioned
ctime=1147521935
description=Запуск нескольких сайтов используя одну копию PmWiki
host=195.98.173.2
name=PmWikiRu.WikiFarms
rev=2
targets=PmWikiRu.WikiGroup,PmWikiRu.Installation,PmWikiRu.LocalCustomizations,PmWikiRu.WikiFarmsAdvanced,PmWikiRu.DocumentationIndex
text=(:title ВикиФермы:)%0a(:description Запуск нескольких сайтов используя одну копию PmWiki:)%0a%0a%25audience%25 администраторам (средний)%0a%0aВикиФерма это коллекция из двух или более вики запущеных на одном веб сервере и пользующихся одним набором сценариев.  Термин ''ВикиФерма'' происходит из компьютерной фразы "server farm"(группа серверов [-Lingvo 11-]).%0a%0aЭта страница даёт некоторые базовые сведения о ВикиФермах и описывает как, добавив ещё одну вики, преобразовать "обычную" настройку в ферму.  Есть несколько способов настроить вики фермы, но в стремлении сделать это как можно проще для администратора делающего ферму первый раз, эта страница описывает только один.%0a%0a%0a!!Когда нужна ферма%0aОсновная мотивация для использования ферм вики это уменьшение объёма административной работы связаной с управлением несколькими вики.  На ферме основной код PmWiki хранится в одном месте и является общим для всех вики.  Администратор может(например) обновить версию PmWiki всех вики простым обновлением общих компонентов собраных в одном месте.%0a%0aС точки зрения читателя, каждая вики на ферме полностью независимая и выглядит как отдельный веб сайт.  Каждая вики на ферме:%0a*обладает собственным URL и даже может распологаться в другом домене;%0a*может иметь собственный дизайн и управление(с помощью разных скинов);%0a*может пользоваться собственными дополнениями или "рецептами" из [[рецептурника -> Cookbook:CookbookBasics]];%0a*может управляться собственным администратором отвечающим за местную настройку.%0a%0a!!Когда ферма не нужна%0aТак как вики на ферме все независимы - довольно трудно (но не невозможно) обеспечить сервисы требующие доступ к более чем одной вики.  Например, функция поиска PmWiki может искать только в пределах одной вики.  Использование фермы для разделения родственного содержимого в целом является плохой идеей.  Удобнее разделить содержимое пользуясь [[группами -> WikiGroup]].%0a%0a!!Я всё ещё не могу выбрать нужна ли мне ферма ...%0aОтличная новость -- вам не надо принимать решение сразу.  В действительности, сначала рекомендуется [[поставить PmWiki->installation]] обычным(одиночным) образом и пользоваться ей.  Создавайте и правьте страницы.  Осваивайте новые рецепты.  Опробуйте [[группы -> WikiGroup]] (возможно их хватит полностью).%0a%0aКак только вы решили, что вам нужна дополнительная вики, у вас есть два варианта на выбор:%0a#Сделать полную [[установку ->installation]] PmWiki в новой папке.  Это даст вам полностью независимые вики абсолютно самодостаточные.  Это '''не''' вики ферма.%0a#Сделать вики ферму пользуясь имеющейся вики как "базовой" в которой будут находиться общие компоненты вики.%0a%0aВыбор номер один может быть удачным по нескольким причинам:%0a*это не вики ферма и не требует дополнительных знаний по администрированию -- это просто две установки;%0a*если вы решите перенести одну из вики на другой сервер вам достаточно скопировать папку вики на второй сервер и она будет там работать (при условии что веб сервер и PHP такие же);%0a*вы можете запустить разные версии PmWiki в каждой вики(удобно для проверки новых версий);%0a*неважно как ужастно вы расстроили одну вики, это никак не повлияет на другую.%0a%0aЕсли вы выбрали сделать вики ферму, то тогда продолжайте читать...%0a%0a!!Предпосылки%0aПрежде чем создать ферму убедитесь что:%0a*у вас есть работающая установленая PmWiki готовая стать базой для вашей фермы;%0a*все вики на вашей ферме будут размещены на одном веб сервере;%0a*каждая вики обладает собственным URL, таким как http://www.example.com/wiki1/, http://www.example.com/wiki2/, http://another.example.com/wiki1/ и такд далее.%0a%0a!!Создание базы вики%0aК этому моменту вы обладаете работающей PmWiki, не так ли?  Это хорошо, потому что эта вики станец базовой вики для вашей фермы.%0a%0aВ папке содержащей существующую вики создайте файл ''local/farmconfig.php''.  Этот файл используется для хранения любых [[местных подстроек -> local customizations]] воздействующих на всю ферму.  Например, вы могли бы назначить пароль администратора в ''farmconfig.php'' используемый всеми вики на вашей ферме.%0a%0aЕсли URL используемый для доступа к имеющейся вики это http://www.example.com/pmwiki/, тогда наипростейший файл ''farmconfig.php'' будет выглядеть так:%0a%0a    [@%3c?php if (!defined('PmWiki')) exit();%0a      $FarmPubDirUrl = 'http://www.example.com/pmwiki/pub';@]%0a%0aЭтот код заполняет переменную $FarmPubDirUrl значением URL папки ''pub/'' вашей базовой вики.  Все вики вашей фермы совместно используют эту папку.  Папка ''pub/'' хранит определения скинов и кнопки GUI-редактора и являются общими для всех вики на ферме.%0a%0aВы наверно удивитесь, но это полностью достаточные изменения необходимые вам для преобразования имеющейся вики в базу для фермы.%0a%0a!!Добавление вики на вашу ферму%0a1. Сделайте папку для новой вики.  Она должна быть доступна через веб, так же как и папка с базовой вики.%0a%0a2. Создайте в ней файл с именем ''index.php'' со следующим содержимым:%0a%0a    %3c?php include([='=]''путь/до/pmwiki.php''');%0a%0aЭто позволяет новой вики пользоваться кодом PmWiki из базовой вики.  ''Путь/до/pmwiki.php'' -- это путь к файлу ''pmwiki.php'' из вашей базовой вики.  Путь к файлу может быть прямым([@/home/username/pmwiki/pmwiki.php@]) или относительным([@../pmwiki/pmwiki.php@]). Не используйте URL путь -- в нём не должно быть конструкции подобной '[@http://@]'.  Для веб сервера под Windows вам надо использовать полный путь к файлу([@C:/Apache Group/Apache2/www/mynewwiki/@]).%0a%0a3. Откройте в веб броузере URL новой вики.  Этот адрес будет начинаться с '[@http://@]'.  При этом PmWiki автоматически попытается создать папку ''wiki.d/'' для хранения страниц вики с корректными правами.  Если вы видите сообщение об ошибке, то следуйте указаным инструкциям.  Если вы выберете опцию "слегка более безопасной установки"("slightly more secure installation") убедитесь, что обе команды выполнены.%0a%0aПоздравляю, ваша новая вики теперь установлена и на вашей ферме уже две вики. Для добавления других вики просто повторите эти три этапа.%0a%0a%0a!!Подстройка%0aКаждая вики с фермы наследует настройки хранящиеся в ''farmconfig.php''.  Для воздействия на всю ферму (все вики) делайте подстройки в файле ''farmconfig.php''.%0a%0aДля хранения [[местных подстроек -> local customizations]] воздействующих только на одну вики в папке каждой вики создайте папку ''local/''.  Подстройки действующие на все вики обрабатываются до индивидуальных подстроек вики.%0a%0aПеременная PmWiki ''$FarmD'' указывает на папку в которой установлена pmwiki.php и ваша базовая вики, и она используется как префикс для доступа других вики к общим компонентам PmWiki.  Например:%0a*''$FarmD/scripts/'' указывает на общую папку ''scripts/''%0a*''$FarmD/pub/'' указывает на общую папку ''pub/''%0a*''$FarmD/cookbook/'' указывает на общую папку ''cookbook/''%0a%0a%0a!!Замечания%0a*Невозможно упомнить, что не все рецепты из рецептурника были написаны и протестированы в контексте ферм.  Обязательно убедитесь что вы просмотрели инструкции о применении рецепта на ферме.%0a*Есть множество, множество других вещей которые можно сделать с фермами.  Некоторые описаны в [[WikiFarmsAdvanced|+]], которая также содержит ссылки на шаг-за-шагом примеры насройки фермы.%0a%0a%0a%25trail%25%3c%3c|[[Documentation Index|+]]|>>
time=1147522150
title=ВикиФермы
