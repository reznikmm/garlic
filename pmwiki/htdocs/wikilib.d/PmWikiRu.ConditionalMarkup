version=pmwiki-2.1.3 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.1) Gecko/20060111 Firefox/1.5.0.1
author=Holo
csum=translated
ctime=1142529433
host=195.98.173.2
name=PmWikiRu.ConditionalMarkup
rev=2
targets=PmWikiRu.DocumentationIndex
text=(:title Условная разметка:)%0a%0a%25define=indent block margin-left=2em text-indent:0em%25%0a%25audience%25 авторам, администраторам (продвинутый)%0a%0a!! Использование директивы [=(:if:)=]%0aДиректива [@(:if:)@] позволяет включать или выключать обработку части страницы.%0a%0aОбщая форма этой директивы такая:%0a%0a%25indent%25&nbsp;[@(:if условие параметр:) текст (:ifend:)@]%0a%0aгде "условие" - это проверяемое условие (описано ниже), а "параметр" - это параметр или аргумент условия. Если условие "истинно"(TRUE), то [@текст@] будет включен, а если "ложно"(FALSE) - исключен из обработки страницы.%0a%0aВстроеные условия включают:%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=15:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if name ИМЯСТРАНИЦЫ:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)текущая страница называется "[@ИМЯСТРАНИЦЫ@]"%0a(:cellnr:)[@(:if group ИМЯГРУППЫ:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)текущая группа называется "[@ИМЯГРУППЫ@]"%0a(:cellnr:)[@(:if auth УРОВЕНЬ:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)пользователь имеет авторизационный "[@УРОВЕНЬ@]", где [@УРОВЕНЬ@] может быть: [@read@], [@edit@], [@upload@], [@attr@] или [@admin@]%0a(:cellnr:)[@(:if authid:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)пользователь авторизован%0a(:cellnr:)[@(:if true:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)всегда включает обработку текста%0a(:cellnr:)[@(:if false:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)всегда выключает текст (тоже что и коментарий)%0a(:cellnr:)[@(:if attachments:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)у текущей страницы есть присоеденённые файлы%0a(:cellnr:)[@(:if date ДАТА:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)настоящая дата совпадает с [@ДАТА@]%0a(:cellnr:)[@(:if date ДАТА..:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)настоящая дата совпадает с [@ДАТА@] или позднее (неограничено)%0a(:cellnr:)[@(:if date ДАТА1..ДАТА2:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)нынешняя дата в диапазоне между [@ДАТА1@] и [@ДАТА2@] (включительно)%0a(:cellnr colspan=3 align=center:)%0a%25green center%25[-''все даты в формате гггг-мм-чч или ггггммчч''-]%0a%0a(:cellnr:)[@(:if enabled VAR:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)PHP переменная VAR истинна (==true)%0a(:cellnr:)[@(:if equal СТРОКА1 СТРОКА2:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)[@СТРОКА1@] совпадает с [@СТРОКА2@]%0a(:cellnr:)[@(:if match РЕГВЫР:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)имя текущей страницы подходит под регулярное выражение [@РЕГВЫР@]%0a(:cellnr:)[@(:if exists ИмяСтраницы:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)страница ''ИмяСтраницы'' существует%0a(:tableend:)%0a%0a(:if false:)%0a/////////////////////////////////////////////////////////////////////%0aКогда добавляете строки в эту таблицу обязательно поправьте rowspan первой колонки!%0a/////////////////////////////////////////////////////////////////////%0a(:if:)%0a%0aТакже работают обратные формы условий:%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=5:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if !attachments:)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)у страницы нет добавленых файлов%0a(:cellnr colspan=3:)&nbsp;%0a(:cellnr:)[@(:if ! name ИмяСтраницы:)@]%0a(:cell rowspan=3:)%0a(:cell rowspan=3 valign=middle:)текущая страница не называется "[@ИмяСтраницы@]"%0a(:cellnr:)[@(:if name -ИмяСтраницы :)@]%0a(:cell:)%0a(:cellnr:)[@(:if name !ИмяСтраницы :)@]%0a(:tableend:)%0a%0aЛюбая директива [@(:if:)@] автоматически прерывает предыдущую, так что можно легко сделать выбор варианта(без вложености):%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=4:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if auth read:)* Вам дозволено читать@]%0a(:cellnr:)[@(:if auth edit:)* Вам дозволено редактировать@]%0a(:cellnr:)[@(:if auth upload:)* Вам дозволено закачивать файлы@]%0a(:cellnr:)[@(:ifend:)@]%0a(:tableend:)%0a%0a!!! Использование символов обобщения ('*' и '?')(:if false:)%25green%25[-(новое в pmwiki 2.1.beta21)-]:(:if:)%0aЗнак звезда ([@*@]) - это обощение обозначающее любую последовательность символов, в том числе и пусто, которая может быть расположена на его месте.\\%0aА знак вопроса ([@?@]) - это обобщение обозначающее любой символ на его месте.%0a%0aСимволы обобщения ([@*@] и [@?@]) используются в условной разметке:%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=3:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if name PmCal.2005* :)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)текущая страница принадлежит группе PmCal и её имя начинается с 2005%0a(:cellnr:)[@(:if group PmWiki* :)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)имя группы страницы начинается с [@PmWiki@]%0a(:cellnr:)[@(:if name Profiles.*,-Profiles.Profiles :)@]%0a(:cell:)&nbsp;-&nbsp;%0a(:cell:)страница в группе [@Profiles@], но не [@Profiles.Profiles@]%0a(:tableend:)%0a%0a!!! Смешаные условия%0aУсловия (определённые ранее) можно комбинировать в более сложные выражения. Для этого используется одна из трёх эквивалентных форм:%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=3:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if expr ВЫРАЖЕНИЕ :)@]%0a(:cellnr:)[@(:if [ ВЫРАЖЕНИЕ ] :)@]%0a(:cellnr:)[@(:if ( ВЫРАЖЕНИЕ ) :)@]%0a(:tableend:)%0a%0aУсловия комбинируются в выражения с помощью двоичных операторов и скобок. В следующей таблице, буквами А и Б обозначаются условия или подвыражения взятые в скобки:%0a%0a>>indent%3c%3c%0a|| border=1 cellpadding=2 cellspacing=0%0a||! Выражение ||! Оператор ||! Результат "истинно"||%0a|| [@А and Б@] || And ||Если А и Б истинны||%0a|| [@А or Б@] || Or ||Если А или Б истинно||%0a|| [@А xor Б@] || Xor ||Если А и Б истинны, или А и Б ложны||%0a|| [@! A@] || Not ||Если А ложно||%0a|| [@А && Б@] || And ||Если А и Б истинны||%0a|| [@А || Б@] || Or ||Если А или Б истинно||%0a>>%3c%3c%0a%0aОбратите внимание, что:%0a* %25red%25 пробелы вокруг операторов и скобок обязательны;%0a* При синтаксических ошибках или непарных скобках поведение условий непредсказуемо.%0a%0aОтсюда запись:%0a%0a(:table border=0 cellpadding=0 cellspacing=0 valign=top:)%0a(:cellnr rowspan=3:)%0a%25indent%25&nbsp;%0a(:cell:)[@(:if expr auth admin || auth attr || auth edit :)@]%0a(:cellnr:)[@[[Logout -> {$Name}?action=logout]]@]%0a(:cellnr:)[@(:if:)@]%0a(:tableend:)%0a%0aпредлагает ''logout'' ссылку ''только'' когда авторизация с правами больше, чем 'read'(просмотр).%0a%0a%25audience%25 администраторам (продвинутый)%0a!! Добавление новых условий%0a%0aСмотри [[Cookbook:ConditionalMarkupSamples]].%0a%0a%0a%25trail%25%3c%3c|[[Documentation Index|+]]|>>
time=1142947803
title=Условная разметка
