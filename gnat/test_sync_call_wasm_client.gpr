with "garlic.gpr";
with "adawebpack_config.gpr";
with "adawebpack.gpr";

project Test_Sync_Call_Wasm_Client is

   for Target use "llvm";
   for Object_Dir use "../.objs/test/sync_call_wasm_cli";
   for Source_Dirs use ("../Tests/echo", "../Tests/echo/client");
   for Main use ("main.adb");
   for Exec_Dir use "../Tests/echo";

   for Excluded_Source_Files use ("remote.adb");

   Default_Switches := AdaWebPack_Config.Compiler'Switches ("Ada");

   package Compiler is
      for Default_Switches ("Ada") use Default_Switches;
      for Switches ("remote.ads") use Default_Switches & ("-gnatzc");
   end Compiler;

   package Binder is
      for Switches ("Ada") use ("-z");
   end Binder;

   package Linker is
      for Switches ("Ada") use ("--target=wasm32", "-nostdlib", "-Wl,--export-all", "-Wl,--allow-undefined", "-Wl,--no-entry");
   end Linker;

   package Builder is
      for Executable ("main.adb") use "main.wasm";
   end Builder;

end Test_Sync_Call_Wasm_Client;
